<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CARVY - Sistema de Gestión Médica</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/png" href="assets/logo.png">
</head>
<body>
    <!-- Pantalla de Login -->
    <div id="loginScreen" class="screen active">
        <div class="container">
            <img src="assets/raccoon.png" alt="Mascota" class="mascot">
            <div class="header">
                <div class="logo-container">
                    <img src="assets/logo.png" alt="CARVY Logo" class="logo">
                    <p>Sistema de Gestión Médica</p>
                </div>
            </div>
            
            <div class="auth-section">
                <!-- Registro -->
                <div class="auth-card">
                    <h3>Registrarse</h3>
                    <form id="registerForm">
                        <div class="form-group">
                            <label>Nombre Completo:</label>
                            <input type="text" id="regName" required>
                        </div>
                        <div class="form-group">
                            <label>Email:</label>
                            <input type="email" id="regEmail" required>
                        </div>
                        <div class="form-group">
                            <label>Contraseña:</label>
                            <input type="password" id="regPassword" required>
                        </div>
                        <div class="form-group">
                            <label>Tipo de Usuario:</label>
                            <select id="regType" required>
                                <option value="">Seleccionar...</option>
                                <option value="doctor">Doctor</option>
                                <option value="patient">Paciente</option>
                            </select>
                        </div>
                        <div id="doctorFields" class="hidden">
                            <div class="form-group">
                                <label>Especialidad:</label>
                                <input type="text" id="specialty">
                            </div>
                            <div class="form-group">
                                <label>Cédula Profesional:</label>
                                <input type="text" id="license">
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Registrarse</button>
                    </form>
                </div>

                <!-- Login -->
                <div class="auth-card">
                    <h3>Iniciar Sesión</h3>
                    <form id="loginForm">
                        <div class="form-group">
                            <label>Email:</label>
                            <input type="email" id="loginEmail" required>
                        </div>
                        <div class="form-group">
                            <label>Contraseña:</label>
                            <input type="password" id="loginPassword" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Iniciar Sesión</button>
                        <button type="button" class="btn btn-secondary" onclick="adminLogin()">Acceso Admin</button>
                    </form>
                    <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #eee; font-size: 0.9rem; color: #666;">
                        <strong>Credenciales de prueba:</strong><br>
                        Doctor: doctor@carvy.com / doctor123<br>
                        Paciente: patient@carvy.com / patient123<br>
                        Admin: Usar botón "Acceso Admin"
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard Admin -->
    <div id="adminDashboard" class="screen">
        <div class="container">
            <img src="assets/raccoon.png" alt="Mascota" class="mascot">
            <div class="header">
                <div class="logo-container">
                    <img src="assets/logo.png" alt="CARVY Logo" class="logo-small">
                    <h1>Panel Administrador</h1>
                </div>
                <button class="btn btn-secondary logout-btn" onclick="logout()">Cerrar Sesión</button>
            </div>
            
            <div class="nav">
                <button class="nav-btn active" onclick="showSection('dashboard')">Dashboard</button>
                <button class="nav-btn" onclick="showSection('doctors')">Doctores</button>
                <button class="nav-btn" onclick="showSection('patients')">Pacientes</button>
                <button class="nav-btn" onclick="showSection('consultations')">Consultas</button>
                <button class="nav-btn" onclick="showSection('prescriptions')">Recetas</button>
            </div>

            <!-- Dashboard -->
            <div id="dashboard" class="section active">
                <h2>Dashboard Administrativo</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                    <div class="profile-card">
                        <h3>Total Doctores</h3>
                        <p id="totalDoctors" style="font-size: 2rem; color: #4ecdc4; font-weight: bold;">0</p>
                    </div>
                    <div class="profile-card">
                        <h3>Total Pacientes</h3>
                        <p id="totalPatients" style="font-size: 2rem; color: #44a08d; font-weight: bold;">0</p>
                    </div>
                    <div class="profile-card">
                        <h3>Total Consultas</h3>
                        <p id="totalConsultations" style="font-size: 2rem; color: #ffc107; font-weight: bold;">0</p>
                    </div>
                    <div class="profile-card">
                        <h3>Total Recetas</h3>
                        <p id="totalPrescriptions" style="font-size: 2rem; color: #dc3545; font-weight: bold;">0</p>
                    </div>
                </div>
            </div>

            <!-- Sección Doctores -->
            <div id="doctors" class="section">
                <div class="section-header">
                    <h2>Gestión de Doctores</h2>
                    <button class="btn btn-primary" onclick="showModal('addDoctorModal')">Agregar Doctor</button>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nombre</th>
                                <th>Email</th>
                                <th>Especialidad</th>
                                <th>Cédula</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="doctorsTable"></tbody>
                    </table>
                </div>
            </div>

            <!-- Sección Pacientes -->
            <div id="patients" class="section">
                <div class="section-header">
                    <h2>Gestión de Pacientes</h2>
                    <button class="btn btn-primary" onclick="showModal('addPatientModal')">Agregar Paciente</button>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nombre</th>
                                <th>Email</th>
                                <th>Teléfono</th>
                                <th>Edad</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="patientsTable"></tbody>
                    </table>
                </div>
            </div>

            <!-- Sección Consultas -->
            <div id="consultations" class="section">
                <div class="section-header">
                    <h2>Gestión de Consultas</h2>
                    <button class="btn btn-primary" onclick="showModal('addConsultationModal')">Agregar Consulta</button>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Doctor</th>
                                <th>Paciente</th>
                                <th>Fecha</th>
                                <th>Diagnóstico</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="consultationsTable"></tbody>
                    </table>
                </div>
            </div>

            <!-- Sección Recetas -->
            <div id="prescriptions" class="section">
                <div class="section-header">
                    <h2>Gestión de Recetas</h2>
                    <button class="btn btn-primary" onclick="showModal('addPrescriptionModal')">Agregar Receta</button>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Doctor</th>
                                <th>Paciente</th>
                                <th>Fecha</th>
                                <th>Medicamento</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="prescriptionsTable"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard Doctor -->
    <div id="doctorDashboard" class="screen">
        <div class="container">
            <img src="assets/raccoon.png" alt="Mascota" class="mascot">
            <div class="header">
                <div class="logo-container">
                    <img src="assets/logo.png" alt="CARVY Logo" class="logo-small">
                    <h1>Panel Doctor</h1>
                </div>
                <button class="btn btn-secondary logout-btn" onclick="logout()">Cerrar Sesión</button>
            </div>
            
            <div class="nav">
                <button class="nav-btn active" onclick="showSection('myPatients')">Mis Pacientes</button>
                <button class="nav-btn" onclick="showSection('myConsultations')">Mis Consultas</button>
                <button class="nav-btn" onclick="showSection('myPrescriptions')">Mis Recetas</button>
            </div>

            <div id="myPatients" class="section active">
                <h2>Mis Pacientes</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Email</th>
                                <th>Teléfono</th>
                                <th>Última Consulta</th>
                            </tr>
                        </thead>
                        <tbody id="doctorPatientsTable"></tbody>
                    </table>
                </div>
            </div>

            <div id="myConsultations" class="section">
                <h2>Mis Consultas</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Paciente</th>
                                <th>Fecha</th>
                                <th>Diagnóstico</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tbody id="doctorConsultationsTable"></tbody>
                    </table>
                </div>
            </div>

            <div id="myPrescriptions" class="section">
                <h2>Mis Recetas</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Paciente</th>
                                <th>Medicamentos</th>
                                <th>Fecha</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tbody id="doctorPrescriptionsTable"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard Paciente -->
    <div id="patientDashboard" class="screen">
        <div class="container">
            <img src="assets/raccoon.png" alt="Mascota" class="mascot">
            <div class="header">
                <div class="logo-container">
                    <img src="assets/logo.png" alt="CARVY Logo" class="logo-small">
                    <h1>Mi Portal</h1>
                </div>
                <button class="btn btn-secondary logout-btn" onclick="logout()">Cerrar Sesión</button>
            </div>
            
            <div class="nav">
                <button class="nav-btn active" onclick="showSection('myAppointments')">Mis Citas</button>
                <button class="nav-btn" onclick="showSection('myHistory')">Mi Historial</button>
                <button class="nav-btn" onclick="showSection('myPrescriptionsList')">Mis Recetas</button>
                <button class="nav-btn" onclick="showSection('myProfile')">Mi Perfil</button>
            </div>

            <!-- Nueva sección de citas -->
            <div id="myAppointments" class="section active">
                <div class="section-header">
                    <h2>Mis Citas Médicas</h2>
                    <button class="btn btn-primary" onclick="showModal('scheduleConsultationModal')">Agendar Nueva Cita</button>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Fecha y Hora</th>
                                <th>Doctor</th>
                                <th>Especialidad</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="upcomingAppointmentsTable"></tbody>
                    </table>
                </div>
            </div>

            <div id="myHistory" class="section">
                <h2>Mi Historial Médico</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Doctor</th>
                                <th>Diagnóstico</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tbody id="patientHistoryTable"></tbody>
                    </table>
                </div>
            </div>

            <div id="myPrescriptionsList" class="section">
                <h2>Mis Recetas Médicas</h2>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Doctor</th>
                                <th>Medicamentos</th>
                                <th>Instrucciones</th>
                            </tr>
                        </thead>
                        <tbody id="patientPrescriptionsTable"></tbody>
                    </table>
                </div>
            </div>

            <div id="myProfile" class="section">
                <h2>Mi Perfil</h2>
                <div class="profile-card">
                    <div id="profileInfo"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modales -->
    <div id="addDoctorModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addDoctorModal')">&times;</span>
            <h3>Agregar Doctor</h3>
            <form id="addDoctorForm">
                <div class="form-group">
                    <label>Nombre:</label>
                    <input type="text" name="name" required>
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Especialidad:</label>
                    <input type="text" name="specialty" required>
                </div>
                <div class="form-group">
                    <label>Cédula:</label>
                    <input type="text" name="license" required>
                </div>
                <button type="submit" class="btn btn-primary">Agregar</button>
            </form>
        </div>
    </div>

    <div id="addPatientModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addPatientModal')">&times;</span>
            <h3>Agregar Paciente</h3>
            <form id="addPatientForm">
                <div class="form-group">
                    <label>Nombre:</label>
                    <input type="text" name="name" required>
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Teléfono:</label>
                    <input type="tel" name="phone" required>
                </div>
                <div class="form-group">
                    <label>Edad:</label>
                    <input type="number" name="age" required min="1" max="120">
                </div>
                <button type="submit" class="btn btn-primary">Agregar</button>
            </form>
        </div>
    </div>

    <div id="addConsultationModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addConsultationModal')">&times;</span>
            <h3>Agregar Consulta</h3>
            <form id="addConsultationForm">
                <div class="form-group">
                    <label>Doctor:</label>
                    <select name="doctorId" required>
                        <option value="">Seleccionar Doctor</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Paciente:</label>
                    <select name="patientId" required>
                        <option value="">Seleccionar Paciente</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Fecha:</label>
                    <input type="datetime-local" name="date" required>
                </div>
                <div class="form-group">
                    <label>Diagnóstico:</label>
                    <textarea name="diagnosis" required></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Agregar</button>
            </form>
        </div>
    </div>

    <div id="addPrescriptionModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addPrescriptionModal')">&times;</span>
            <h3>Agregar Receta</h3>
            <form id="addPrescriptionForm">
                <div class="form-group">
                    <label>Doctor:</label>
                    <select name="doctorId" required>
                        <option value="">Seleccionar Doctor</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Paciente:</label>
                    <select name="patientId" required>
                        <option value="">Seleccionar Paciente</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Fecha:</label>
                    <input type="datetime-local" name="date" required>
                </div>
                <div class="form-group">
                    <label>Medicamento:</label>
                    <input type="text" name="medication" required>
                </div>
                <div class="form-group">
                    <label>Instrucciones:</label>
                    <textarea name="instructions" required></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Agregar</button>
            </form>
        </div>
    </div>

    <!-- Modal para agendar consulta (paciente) -->
    <div id="scheduleConsultationModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('scheduleConsultationModal')">&times;</span>
            <h3>Agendar Nueva Cita</h3>
            <form id="scheduleConsultationForm">
                <div class="form-group">
                    <label>Seleccionar Doctor:</label>
                    <select name="doctorId" required>
                        <option value="">Seleccionar Doctor</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Fecha y Hora:</label>
                    <input type="datetime-local" name="date" required>
                </div>
                <div class="form-group">
                    <label>Motivo de la consulta:</label>
                    <textarea name="reason" required placeholder="Describe brevemente el motivo de tu consulta..."></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Agendar Cita</button>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="database.js"></script>
    <script src="auth.js"></script>
    <script src="admin.js"></script>
    <script src="doctor.js"></script>
    <script src="patient.js"></script>
    <script src="app.js"></script>
</body>
</html>